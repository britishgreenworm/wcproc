<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>WCPROC</title>

    <!-- Bootstrap -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>

  </head>
  <body>
    <h1>CNN Word Cloud</h1>

    <div id="container" style="min-width: 310px; height: 950px; margin: 0 auto"></div>

    <script type="text/javascript">

    function worker() {

      $.get("/api/getwords", function (data) {

          data = JSON.parse(data);

          var names = [];
          var counts = [];

          for (var i = 0, len = data.length; i < len; i++) {
            if (data[i].name != "")
            {
              names.push(data[i].name);
              counts.push(data[i].count);
            }
          }

          $('#container').highcharts({
              chart: {
                  type: 'bar'
              },
              xAxis: {
                  categories: names,
                  title: {
                      text: null
                  }
              },
              plotOptions: {
                  bar: {
                      dataLabels: {
                          enabled: true
                      }
                  }
              },
              credits: {
                  enabled: false
              },
              series: [{
                  data: counts
              }]
          });

          setTimeout(worker, 300000);

      });

    }

    worker();
    </script>
  </body>
</html>
